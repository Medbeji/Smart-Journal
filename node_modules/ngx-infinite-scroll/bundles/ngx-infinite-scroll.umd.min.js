!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("rxjs/Observable"),require("rxjs/add/observable/fromEvent"),require("rxjs/add/observable/of"),require("rxjs/add/operator/sampleTime"),require("rxjs/add/operator/filter"),require("rxjs/add/operator/mergeMap")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/Observable","rxjs/add/observable/fromEvent","rxjs/add/observable/of","rxjs/add/operator/sampleTime","rxjs/add/operator/filter","rxjs/add/operator/mergeMap"],factory):factory((global.ng=global.ng||{},global.ng.ngxInfiniteScroll=global.ng.ngxInfiniteScroll||{}),global.ng.core,global.Rx)}(this,function(exports,_angular_core,rxjs_Observable){"use strict";var AxisResolverFactory=function(){function AxisResolverFactory(){}return AxisResolverFactory.prototype.create=function(vertical){return void 0===vertical&&(vertical=!0),new AxisResolver(vertical)},AxisResolverFactory}();AxisResolverFactory.decorators=[{type:_angular_core.Injectable}],AxisResolverFactory.ctorParameters=function(){return[]};var AxisResolver=function(){function AxisResolver(vertical){void 0===vertical&&(vertical=!0),this.vertical=vertical}return AxisResolver.prototype.clientHeightKey=function(){return this.vertical?"clientHeight":"clientWidth"},AxisResolver.prototype.offsetHeightKey=function(){return this.vertical?"offsetHeight":"offsetWidth"},AxisResolver.prototype.scrollHeightKey=function(){return this.vertical?"scrollHeight":"scrollWidth"},AxisResolver.prototype.pageYOffsetKey=function(){return this.vertical?"pageYOffset":"pageXOffset"},AxisResolver.prototype.offsetTopKey=function(){return this.vertical?"offsetTop":"offsetLeft"},AxisResolver.prototype.scrollTopKey=function(){return this.vertical?"scrollTop":"scrollLeft"},AxisResolver.prototype.topKey=function(){return this.vertical?"top":"left"},AxisResolver}(),PositionResolverFactory=function(){function PositionResolverFactory(axisResolver){this.axisResolver=axisResolver}return PositionResolverFactory.prototype.create=function(options){return new PositionResolver(this.axisResolver.create(!options.horizontal),options)},PositionResolverFactory}();PositionResolverFactory.decorators=[{type:_angular_core.Injectable}],PositionResolverFactory.ctorParameters=function(){return[{type:AxisResolverFactory}]};var PositionResolver=function(){function PositionResolver(axis,options){this.axis=axis,this.options=options,this.resolveContainer(this.options.windowElement),this.defineContainer(this.options.windowElement)}return PositionResolver.prototype.defineContainer=function(windowElement){return this.resolveContainer(windowElement)||!windowElement.nativeElement?this.container=windowElement:this.container=windowElement.nativeElement,this.container},PositionResolver.prototype.resolveContainer=function(windowElement){var isContainerWindow=Object.prototype.toString.call(windowElement).includes("Window");return this.isContainerWindow=isContainerWindow,isContainerWindow},PositionResolver.prototype.getDocumentElement=function(){return this.isContainerWindow?this.options.windowElement.document.documentElement:null},PositionResolver.prototype.calculatePoints=function(element){return this.isContainerWindow?this.calculatePointsForWindow(element):this.calculatePointsForElement(element)},PositionResolver.prototype.calculatePointsForWindow=function(element){var height=this.height(this.container);return{height:height,scrolledUntilNow:height+this.pageYOffset(this.getDocumentElement()),totalToScroll:this.offsetTop(element.nativeElement)+this.height(element.nativeElement)}},PositionResolver.prototype.calculatePointsForElement=function(element){var scrollTop=this.axis.scrollTopKey(),scrollHeight=this.axis.scrollHeightKey(),container=this.container,height=this.height(container),scrolledUntilNow=container[scrollTop],offsetTop=this.offsetTop(container);return void 0!==offsetTop&&offsetTop,{height:height,scrolledUntilNow:scrolledUntilNow,totalToScroll:container[scrollHeight]}},PositionResolver.prototype.height=function(elem){var offsetHeight=this.axis.offsetHeightKey(),clientHeight=this.axis.clientHeightKey();return isNaN(elem[offsetHeight])?this.getDocumentElement()[clientHeight]:elem[offsetHeight]},PositionResolver.prototype.offsetTop=function(elem){var top=this.axis.topKey();if(elem.getBoundingClientRect)return elem.getBoundingClientRect()[top]+this.pageYOffset(elem)},PositionResolver.prototype.pageYOffset=function(elem){var pageYOffset=this.axis.pageYOffsetKey(),scrollTop=this.axis.scrollTopKey(),offsetTop=this.axis.offsetTopKey();return isNaN(window[pageYOffset])?this.getDocumentElement()[scrollTop]:elem.ownerDocument?elem.ownerDocument.defaultView[pageYOffset]:elem[offsetTop]},PositionResolver}(),ScrollRegister=function(){function ScrollRegister(){}return ScrollRegister.prototype.attachEvent=function(options){return rxjs_Observable.Observable.fromEvent(options.container,"scroll").sampleTime(options.throttleDuration).filter(options.filterBefore).mergeMap(function(ev){return rxjs_Observable.Observable.of(options.mergeMap(ev))}).subscribe(options.scrollHandler)},ScrollRegister}();ScrollRegister.decorators=[{type:_angular_core.Injectable}],ScrollRegister.ctorParameters=function(){return[]};var ScrollResolver=function(){function ScrollResolver(){this.lastScrollPosition=0}return ScrollResolver.prototype.shouldScroll=function(container,config,scrollingDown){var remaining,containerBreakpoint,distance=config.distance;scrollingDown?(remaining=container.totalToScroll-container.scrolledUntilNow,containerBreakpoint=container.height*distance.down+1):(remaining=container.scrolledUntilNow,containerBreakpoint=container.height*distance.up+1);var shouldScroll=remaining<=containerBreakpoint;return this.lastScrollPosition=container.scrolledUntilNow,shouldScroll},ScrollResolver.prototype.isScrollingDown=function(container){return this.lastScrollPosition<container.scrolledUntilNow},ScrollResolver.prototype.getScrollStats=function(container,config){var isScrollingDown=this.isScrollingDown(container);return{isScrollingDown:isScrollingDown,shouldScroll:this.shouldScroll(container,config,isScrollingDown)}},ScrollResolver}();ScrollResolver.decorators=[{type:_angular_core.Injectable}],ScrollResolver.ctorParameters=function(){return[]};var InfiniteScrollDirective=function(){function InfiniteScrollDirective(element,zone,positionResolverFactory,scrollRegister,scrollerResolver){this.element=element,this.zone=zone,this.positionResolverFactory=positionResolverFactory,this.scrollRegister=scrollRegister,this.scrollerResolver=scrollerResolver,this.scrolled=new _angular_core.EventEmitter,this.scrolledUp=new _angular_core.EventEmitter,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=300,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1}return InfiniteScrollDirective.prototype.ngOnInit=function(){var _this=this;if("undefined"!=typeof window){var containerElement=this.resolveContainerElement(),positionResolver_1=this.positionResolverFactory.create({horizontal:this.horizontal,windowElement:containerElement}),options={container:positionResolver_1.container,filterBefore:function(){return!_this.infiniteScrollDisabled},mergeMap:function(){return positionResolver_1.calculatePoints(_this.element)},scrollHandler:function(container){return _this.handleOnScroll(container)},throttleDuration:this.infiniteScrollThrottle};this.disposeScroller=this.scrollRegister.attachEvent(options)}},InfiniteScrollDirective.prototype.handleOnScroll=function(container){var scrollResolverConfig={distance:{down:this.infiniteScrollDistance,up:this.infiniteScrollUpDistance}},scrollStats=this.scrollerResolver.getScrollStats(container,scrollResolverConfig);if(this.shouldTriggerEvents(scrollStats.shouldScroll)){var infiniteScrollEvent={currentScrollPosition:container.scrolledUntilNow};scrollStats.isScrollingDown?this.onScrollDown(infiniteScrollEvent):this.onScrollUp(infiniteScrollEvent)}},InfiniteScrollDirective.prototype.shouldTriggerEvents=function(shouldScroll){return(this.alwaysCallback||shouldScroll)&&!this.infiniteScrollDisabled},InfiniteScrollDirective.prototype.ngOnDestroy=function(){this.disposeScroller&&this.disposeScroller.unsubscribe()},InfiniteScrollDirective.prototype.onScrollDown=function(data){var _this=this;void 0===data&&(data={currentScrollPosition:0}),this.zone.run(function(){return _this.scrolled.emit(data)})},InfiniteScrollDirective.prototype.onScrollUp=function(data){var _this=this;void 0===data&&(data={currentScrollPosition:0}),this.zone.run(function(){return _this.scrolledUp.emit(data)})},InfiniteScrollDirective.prototype.resolveContainerElement=function(){var selector=this.infiniteScrollContainer,hasWindow=window&&window.hasOwnProperty("document"),containerIsString=selector&&hasWindow&&"string"==typeof this.infiniteScrollContainer,container=containerIsString?window.document.querySelector(selector):selector;return selector||(container=this.scrollWindow?window:this.element),container},InfiniteScrollDirective}();InfiniteScrollDirective.decorators=[{type:_angular_core.Directive,args:[{selector:"[infiniteScroll], [infinite-scroll], [data-infinite-scroll]"}]}],InfiniteScrollDirective.ctorParameters=function(){return[{type:_angular_core.ElementRef},{type:_angular_core.NgZone},{type:PositionResolverFactory},{type:ScrollRegister},{type:ScrollResolver}]},InfiniteScrollDirective.propDecorators={scrolled:[{type:_angular_core.Output}],scrolledUp:[{type:_angular_core.Output}],infiniteScrollDistance:[{type:_angular_core.Input}],infiniteScrollUpDistance:[{type:_angular_core.Input}],infiniteScrollThrottle:[{type:_angular_core.Input}],infiniteScrollDisabled:[{type:_angular_core.Input}],infiniteScrollContainer:[{type:_angular_core.Input}],scrollWindow:[{type:_angular_core.Input}],immediateCheck:[{type:_angular_core.Input}],horizontal:[{type:_angular_core.Input}],alwaysCallback:[{type:_angular_core.Input}]};var InfiniteScrollModule=function(){function InfiniteScrollModule(){}return InfiniteScrollModule}();InfiniteScrollModule.decorators=[{type:_angular_core.NgModule,args:[{declarations:[InfiniteScrollDirective],exports:[InfiniteScrollDirective],imports:[],providers:[AxisResolverFactory,PositionResolverFactory,ScrollRegister,ScrollResolver]}]}],InfiniteScrollModule.ctorParameters=function(){return[]},exports.InfiniteScrollModule=InfiniteScrollModule,exports.ɵa=InfiniteScrollDirective,exports.ɵc=AxisResolverFactory,exports.ɵb=PositionResolverFactory,exports.ɵd=ScrollRegister,exports.ɵe=ScrollResolver,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-infinite-scroll.umd.min.js.map
